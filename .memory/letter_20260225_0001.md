# Letter to Myself (Session Handoff)

**Date:** 2026-02-25

## 1. Executive Summary
* **Goal:** Configure OAuth credentials, fix magic link login, deploy to Vercel production.
* **Current Status:** Magic link login debugging — Resend domain `nyxcore.cloud` verified, `EMAIL_FROM` set to `noreply@nyxcore.cloud`, deployed. Awaiting user test of magic link flow. Vercel runtime logs were not captured via CLI streaming (unreliable).

## 2. The "Done" List (Context Anchor)
* Fixed `.env` / `.env.example`: renamed `TIKTOK_CLIENT_KEY` → `TIKTOK_CLIENT_ID` to match code in `oauth-providers.ts` line 46 (commit `2887b54`)
* Set Instagram credentials on Vercel: `INSTAGRAM_CLIENT_ID="sbawt1wo2c4cycvn6m"`, `INSTAGRAM_CLIENT_SECRET`
* Set TikTok credentials on Vercel: `TIKTOK_CLIENT_ID="sbawt1wo2c4cycvn6m"`, `TIKTOK_CLIENT_SECRET="5BeHea0PX57tMYtwFJLVKSMbMtT4llhK"` (same as Instagram per user confirmation)
* Diagnosed magic link error: Resend `onboarding@resend.dev` test sender restricted to account owner email only (`oliver.baer@gmail.com`)
* User verified custom domain `nyxcore.cloud` on Resend (DKIM + SPF verified)
* Set `EMAIL_FROM="Minitik <noreply@nyxcore.cloud>"` on Vercel and locally
* Deployed 3 times to Vercel production (latest: `dpl_3PwrP1CizwXBWR36RRMPycdBnmRJ`)

## 3. The "Pain" Log (CRITICAL)
* **Tried:** TikTok OAuth login
* **Failed:** `client_key` error — env var was `TIKTOK_CLIENT_KEY` but code reads `TIKTOK_CLIENT_ID`
* **Fix:** Renamed env var in `.env` and `.env.example`
* **Tried:** Magic link login on production
* **Failed:** Redirected to `/login?error=EmailSignin` — Resend API returned 403: "You can only send testing emails to your own email address"
* **Fix:** User verified `nyxcore.cloud` domain on Resend, set `EMAIL_FROM=noreply@nyxcore.cloud`
* **Tried:** `vercel logs` CLI streaming to capture runtime errors
* **Failed:** No runtime logs captured — CLI just shows "waiting for new logs..." even when requests are being made
* **Note:** Vercel log streaming via CLI is unreliable for serverless functions. Use Vercel dashboard or REST API instead.
* **Vercel auth file location:** `/Users/oliverbaer/Library/Application Support/com.vercel.cli/auth.json`

## 4. Active Variable State
* Branch: `main`, at commit `2887b54`, pushed to `origin/main`
* No uncommitted code changes (only `.env` local changes which are gitignored)
* Vercel env vars set for production:
  - `TIKTOK_CLIENT_ID="sbawt1wo2c4cycvn6m"`
  - `TIKTOK_CLIENT_SECRET="5BeHea0PX57tMYtwFJLVKSMbMtT4llhK"`
  - `INSTAGRAM_CLIENT_ID="sbawt1wo2c4cycvn6m"`
  - `INSTAGRAM_CLIENT_SECRET="5BeHea0PX57tMYtwFJLVKSMbMtT4llhK"`
  - `EMAIL_FROM="Minitik <noreply@nyxcore.cloud>"`
  - `RESEND_API_KEY` (set earlier)
* Local `.env` matches Vercel for all OAuth + email vars
* Production URL: https://minitik.vercel.app
* TikTok redirect URI: `https://minitik.vercel.app/api/accounts/callback/tiktok`
* Instagram redirect URI: `https://minitik.vercel.app/api/accounts/callback/instagram`

## 5. Immediate Next Steps
1. [ ] Test magic link login on production — should now work with any email via `noreply@nyxcore.cloud`
2. [ ] If magic link still fails, check Vercel dashboard logs (not CLI) for the actual Resend API error
3. [ ] Test TikTok OAuth flow — ensure redirect URI is registered in TikTok Developer Portal
4. [ ] Test Instagram OAuth flow — ensure redirect URI is registered in Meta Developer Portal
5. [ ] Backlog: Replace SHA-256 password hash with bcrypt
6. [ ] Backlog: Expand test coverage for publishing-orchestrator, analytics, adapters
